<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<title>Arda â€“ Son Ã‡ocuk</title>
<style>
body { background:#111; color:#eee; font-family:Arial; padding:20px }
button { margin:3px; padding:5px }
h2 { margin-top:18px }
.box { border:1px solid #444; padding:10px; margin-bottom:10px }
</style>
</head>

<body onload="basla()">

<h1>ğŸ•¯ï¸ Arda â€“ Son Ã‡ocuk</h1>

<div class="box">
  <div>ğŸ“… GÃ¼n: <span id="gun"></span></div>
  <div>ğŸŒ‘ Bu Geceki Tehdit: <b><span id="tehdit"></span></b></div>
  <div>â¤ï¸ Can: <span id="can"></span></div>
  <div>âš¡ Enerji: <span id="enerji"></span></div>
  <div>ğŸ’  Odak: <span id="odak"></span></div>
  <div>â³ AkÅŸama kalan hamle: <span id="zaman"></span></div>
</div>

<div id="yetenekler"></div>

<button onclick="dinlen()">ğŸ’¤ Dinlen</button>

<hr>
<div id="log"></div>

<script>
let maxCan = 10
let maxEnerji = 6

let can, enerji, odak, zaman, gun
let aktifTehdit = ""

let kategoriler = {
  Fiziksel: ["GÃ¼Ã§","HÄ±z","DayanÄ±klÄ±lÄ±k","Ã‡eviklik"],
  Hayatta: ["AvcÄ±lÄ±k","Ä°z sÃ¼rme","BarÄ±nak","Ä°lk yardÄ±m"],
  KaranlÄ±k: ["GÃ¶lge","Korku direnci","AlgÄ± bozma","Sessizlik"],
  Bag: ["Hayvan","Sezgi","DoÄŸa uyumu","Gizli baÄŸ"]
}

let yetenekler = {}

function basla() {
  can = 10
  enerji = 6
  odak = 10
  zaman = 6
  gun = 1

  for (let k in kategoriler) {
    kategoriler[k].forEach(y => yetenekler[y] = 0)
  }

  yeniGun()
}

function yeniGun() {
  zaman = 6
  aktifTehdit = rastgeleKategori()
  yaz(`ğŸŒ… GÃ¼n ${gun} baÅŸladÄ±. Bu gece <b>${aktifTehdit}</b> tehdidi var.`)
  guncelle()
  butonlar()
}

function rastgeleKategori() {
  let keys = Object.keys(kategoriler)
  return keys[Math.floor(Math.random() * keys.length)]
}

function guncelle() {
  document.getElementById("gun").innerText = gun
  document.getElementById("can").innerText = can+"/"+maxCan
  document.getElementById("enerji").innerText = enerji+"/"+maxEnerji
  document.getElementById("odak").innerText = odak
  document.getElementById("zaman").innerText = zaman
  document.getElementById("tehdit").innerText = aktifTehdit
}

function butonlar() {
  let alan = document.getElementById("yetenekler")
  alan.innerHTML = ""

  for (let k in kategoriler) {
    alan.innerHTML += `<h2>${k}</h2>`
    kategoriler[k].forEach(y => {
      alan.innerHTML += `<button onclick="gelistir('${y}')">${y} (${yetenekler[y]})</button>`
    })
  }
}

function gelistir(y) {
  if (enerji < 2 || odak <= 0) {
    yaz("Yorgunsun ya da odak yok.")
    return
  }
  yetenekler[y]++
  enerji -= 2   // ğŸ”¥ BURASI DEÄÄ°ÅTÄ°
  odak--
  zaman--
  yaz(y + " geliÅŸtirildi.")
  kontrol()
}

function dinlen() {
  enerji = Math.min(maxEnerji, enerji + 3)
  can = Math.min(maxCan, can + 1)
  zaman--
  yaz("Dinlendin.")
  kontrol()
}

function kontrol() {
  guncelle()
  butonlar()
  if (zaman <= 0) gece()
  if (can <= 0) {
    yaz(`â˜ ï¸ Arda ${gun}. gÃ¼n hayatta kalamadÄ±.`)
    document.querySelectorAll("button").forEach(b => b.disabled = true)
  }
}

function gece() {
  let toplam = 0
  kategoriler[aktifTehdit].forEach(y => toplam += yetenekler[y])

  let gereken = 6 + gun
  let eksik = Math.max(0, gereken - toplam)

  can -= eksik
  enerji = Math.max(0, enerji - 1)

  yaz(`ğŸŒ‘ Gece oldu. ${aktifTehdit} kontrolÃ¼:
Gereken ${gereken}, sende ${toplam}.
Can -${eksik}, Enerji -1.`)

  gun++
  yeniGun()
}

function yaz(m) {
  document.getElementById("log").innerHTML = "<p>"+m+"</p>"
}
</script>

</body>
</html>
